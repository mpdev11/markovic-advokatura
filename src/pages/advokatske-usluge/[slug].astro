---
import PageLayout from "../../layouts/PageLayout.astro";
import { services } from "../../data/navigation.js";
import { getCollection, type CollectionEntry } from "astro:content";

const basePath = import.meta.env.BASE_URL;

export async function getStaticPaths() {
  const servicesCollection = await getCollection("services");
  return servicesCollection.map((service: CollectionEntry<"services">) => ({
    params: { slug: service.slug },
    props: { service },
  }));
}

const { service }: { service: CollectionEntry<"services"> } = Astro.props;
const { Content } = await service.render();

const navigationService = services.find((s) => s.path.split("/").pop() === service.slug);
---

<PageLayout
  title={(navigationService?.label && `${navigationService.label} | Marković Advokatura`) ||
    (service.data.title && `${service.data.title} | Marković Advokatura`) ||
    "Advokatske usluge | Marković Advokatura"}
  description={navigationService?.description || service.data.description || "Stručna pravna pomoć i savetovanje"}>
  <section class="pt-32 pb-16 lg:pt-44 lg:pb-20">
    <div class="mx-auto max-w-7xl px-6 lg:px-8">
      <div class="mx-auto max-w-4xl border-b border-primary/30 mb-6 pb-6">
        <div class="flex items-center gap-6">
          {
            navigationService?.icon && (
              <div
                class="text-primary w-auto h-20 flex-shrink-0 flex items-center justify-center [&>svg]:w-12 [&>svg]:h-12 md:[&>svg]:w-14 md:[&>svg]:h-14 lg:[&>svg]:w-16 lg:[&>svg]:h-16"
                set:html={navigationService.icon}
              />
            )
          }
          <div class="flex-1">
            <h1 class="service-heading !text-2xl">{service.data.title}</h1>
            <p class="text-lg leading-relaxed text-gray-600 italic">
              {service.data.description}
            </p>
          </div>
        </div>
      </div>

      <div class="mx-auto max-w-4xl">
        <div class="prose prose-lg max-w-full">
          <Content />
        </div>

        <div class="mt-12 flex flex-col sm:flex-row gap-6 justify-center items-center">
          <a
            href={`${basePath}#contact`}
            class="inline-flex items-center justify-center gap-2 px-6 py-3 text-lg font-bold bg-primary rounded-lg transition-all duration-300 text-background shadow-lg hover:bg-primary/90 hover:scale-105">
            <svg class="w-4 h-4" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor">
              <path
                stroke-linecap="round"
                stroke-linejoin="round"
                d="M21.75 6.75v10.5a2.25 2.25 0 01-2.25 2.25h-15a2.25 2.25 0 01-2.25-2.25V6.75m19.5 0A2.25 2.25 0 0019.5 4.5h-15a2.25 2.25 0 00-2.25 2.25m19.5 0v.243a2.25 2.25 0 01-1.07 1.916l-7.5 4.615a2.25 2.25 0 01-2.36 0L3.32 8.91a2.25 2.25 0 01-1.07-1.916V6.75">
              </path>
            </svg>
            Kontaktirajte me
          </a>
          <a
            href={`${basePath}#advokatske-usluge`}
            class="border-b-secondary border-b-2 inline-flex items-center text-lg font-semibold leading-6 text-secondary hover:text-secondary/90 transition-colors duration-200 hover:border-b-secondary/90">
            Pregledajte sve usluge <span aria-hidden="true" class="ml-1">→</span>
          </a>
        </div>
      </div>
    </div>
  </section>
</PageLayout>
